{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.HomeScreen = void 0;\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _taggedTemplateLiteralLoose2 = _interopRequireDefault(require(\"@babel/runtime/helpers/taggedTemplateLiteralLoose\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _mobxReactLite = require(\"mobx-react-lite\");\n\nvar _reactNative = require(\"react-native\");\n\nvar _expoAv = require(\"expo-av\");\n\nvar _theme = require(\"../../theme\");\n\nvar _client = require(\"@apollo/client\");\n\nvar _native = require(\"@react-navigation/native\");\n\nvar _components = require(\"../../components\");\n\nvar _reactNativeSkeletonContent = _interopRequireDefault(require(\"react-native-skeleton-content\"));\n\nvar _jsxFileName = \"/Users/isaacweber/code/SofamApp/app/screens/home-screen/home-screen.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _templateObject() {\n  var data = (0, _taggedTemplateLiteralLoose2.default)([\"\\n  {\\n  users {\\n    id\\n    name\\n    stories {\\n      id\\n      url\\n    }\\n  }\\n}\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar USERS = (0, _client.gql)(_templateObject());\nvar ROOT = {\n  flex: 1\n};\nvar VIDEO = {\n  height: 250,\n  flex: 1\n};\nvar IMAGE = {\n  height: 250,\n  flex: 1,\n  borderRadius: 20\n};\nvar IMAGE_CONTAINER = {\n  flex: 1,\n  marginLeft: _theme.spacing[2],\n  marginRight: _theme.spacing[2]\n};\nvar OVERLAY = {\n  height: '100%',\n  position: \"absolute\",\n  bottom: 0,\n  right: 0,\n  left: 0,\n  backgroundColor: 'rgba(0, 0, 0, .25)',\n  borderRadius: 20,\n  justifyContent: 'flex-end'\n};\nvar OVERLAY_TEXT = {\n  color: _theme.color.palette.white,\n  fontFamily: _theme.typography.primary,\n  fontWeight: '700',\n  fontSize: 18,\n  margin: _theme.spacing[4]\n};\nvar HomeScreen = (0, _mobxReactLite.observer)(function HomeScreen() {\n  var navigation = (0, _native.useNavigation)();\n\n  var _useQuery = (0, _client.useQuery)(USERS),\n      loading = _useQuery.loading,\n      userAndStories = _useQuery.data,\n      refetch = _useQuery.refetch;\n\n  var _useState = (0, _react.useState)(false),\n      _useState2 = (0, _slicedToArray2.default)(_useState, 2),\n      refreshing = _useState2[0],\n      setRefreshing = _useState2[1];\n\n  var onRefresh = _react.default.useCallback(function () {\n    refetch();\n\n    if (loading) {\n      setRefreshing(true);\n    }\n\n    setRefreshing(false);\n  }, []);\n\n  var renderUsers = function renderUsers(_ref) {\n    var _item$stories$;\n\n    var item = _ref.item;\n    var uri = (_item$stories$ = item.stories[0]) == null ? void 0 : _item$stories$.url;\n\n    var renderFirstStory = function renderFirstStory() {\n      if (uri == null ? void 0 : uri.includes('.mov')) {\n        return _react.default.createElement(_expoAv.Video, {\n          source: {\n            uri: uri\n          },\n          rate: 1.0,\n          volume: 0,\n          isMuted: false,\n          resizeMode: \"contain\",\n          shouldPlay: true,\n          isLooping: true,\n          style: VIDEO,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 11\n          }\n        });\n      } else if (uri == null ? void 0 : uri.includes('.jpg' || '.jpeg')) {\n        return _react.default.createElement(_components.ProgressiveImage, {\n          thumbnailSource: {\n            uri: \"https://images.unsplash.com/photo-1557683311-eac922347aa1?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1915&q=80\"\n          },\n          source: {\n            uri: uri\n          },\n          style: IMAGE,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 11\n          }\n        });\n      }\n    };\n\n    return _react.default.createElement(_reactNative.View, {\n      style: IMAGE_CONTAINER,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 7\n      }\n    }, _react.default.createElement(_reactNative.TouchableOpacity, {\n      onPress: function onPress() {\n        return uri ? navigation.navigate('story', _objectSpread({}, item)) : null;\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 9\n      }\n    }, renderFirstStory(), _react.default.createElement(_reactNative.View, {\n      style: OVERLAY,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 11\n      }\n    }, _react.default.createElement(_reactNative.Text, {\n      style: OVERLAY_TEXT,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 13\n      }\n    }, item.name))));\n  };\n\n  var firstLayout = [{\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    flex: 1,\n    justifyContent: 'center',\n    children: [{\n      margin: _theme.spacing[2],\n      height: 250,\n      width: \"45%\"\n    }, {\n      margin: _theme.spacing[2],\n      height: 250,\n      width: \"45%\"\n    }, {\n      margin: _theme.spacing[2],\n      height: 250,\n      width: \"45%\"\n    }, {\n      margin: _theme.spacing[2],\n      height: 250,\n      width: \"45%\"\n    }, {\n      margin: _theme.spacing[2],\n      height: 250,\n      width: \"45%\"\n    }, {\n      margin: _theme.spacing[2],\n      height: 250,\n      width: \"45%\"\n    }]\n  }];\n  return _react.default.createElement(_reactNative.SafeAreaView, {\n    style: ROOT,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 5\n    }\n  }, loading ? _react.default.createElement(_reactNativeSkeletonContent.default, {\n    isLoading: true,\n    layout: firstLayout,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 13\n    }\n  }) : _react.default.createElement(_reactNative.FlatList, {\n    refreshControl: _react.default.createElement(_reactNative.RefreshControl, {\n      refreshing: refreshing,\n      onRefresh: onRefresh,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 29\n      }\n    }),\n    data: userAndStories == null ? void 0 : userAndStories.users,\n    renderItem: renderUsers,\n    keyExtractor: function keyExtractor(item) {\n      return item.id;\n    },\n    showsHorizontalScrollIndicator: false,\n    numColumns: 2,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 13\n    }\n  }));\n});\nexports.HomeScreen = HomeScreen;","map":{"version":3,"sources":["/Users/isaacweber/code/SofamApp/app/screens/home-screen/home-screen.tsx"],"names":["USERS","gql","ROOT","flex","VIDEO","height","IMAGE","borderRadius","IMAGE_CONTAINER","marginLeft","spacing","marginRight","OVERLAY","position","bottom","right","left","backgroundColor","justifyContent","OVERLAY_TEXT","color","palette","white","fontFamily","typography","primary","fontWeight","fontSize","margin","HomeScreen","navigation","loading","userAndStories","data","refetch","refreshing","setRefreshing","onRefresh","React","useCallback","renderUsers","item","uri","stories","url","renderFirstStory","includes","navigate","name","firstLayout","flexDirection","flexWrap","children","width","users","id"],"mappings":"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","sourcesContent":["import React, { FunctionComponent as Component, useState } from \"react\"\nimport { observer } from \"mobx-react-lite\"\nimport {\n  SafeAreaView,\n  FlatList,\n  ImageStyle,\n  ViewStyle,\n  View,\n  Text,\n  RefreshControl,\n  TouchableOpacity,\n  TextStyle,\n} from \"react-native\"\nimport { Video } from 'expo-av'\nimport { color, spacing, typography } from \"../../theme\"\nimport { gql, useQuery } from \"@apollo/client\"\nimport { useNavigation } from \"@react-navigation/native\"\nimport { ProgressiveImage } from \"../../components\"\nimport SkeletonContent from \"react-native-skeleton-content\"\n\nconst USERS = gql`\n  {\n  users {\n    id\n    name\n    stories {\n      id\n      url\n    }\n  }\n}\n`\n\nconst ROOT: ViewStyle = {\n  flex: 1,\n}\n\nconst VIDEO: ViewStyle = {\n  height: 250,\n  flex: 1,\n}\n\nconst IMAGE: ImageStyle = {\n  height: 250,\n  flex: 1,\n  borderRadius: 20,\n}\n\nconst IMAGE_CONTAINER: ViewStyle = {\n  flex: 1,\n  marginLeft: spacing[2],\n  marginRight: spacing[2],\n}\n\nconst OVERLAY: ViewStyle = {\n  height: '100%',\n  position: \"absolute\",\n  bottom: 0,\n  right: 0,\n  left: 0,\n  backgroundColor: 'rgba(0, 0, 0, .25)',\n  borderRadius: 20,\n  justifyContent: 'flex-end'\n}\n\nconst OVERLAY_TEXT: TextStyle = {\n  color: color.palette.white,\n  fontFamily: typography.primary,\n  fontWeight: '700',\n  fontSize: 18,\n  margin: spacing[4],\n}\n\nexport const HomeScreen: Component = observer(function HomeScreen() {\n  const navigation = useNavigation()\n  const { loading, data: userAndStories, refetch } = useQuery(USERS)\n  const [refreshing, setRefreshing] = useState(false)\n\n  const onRefresh = React.useCallback(() => {\n    refetch()\n    if (loading) {\n      setRefreshing(true)\n    }\n    setRefreshing(false)\n  }, [])\n\n  const renderUsers = ({ item }) => {\n    const uri = item.stories[0]?.url\n    const renderFirstStory = () => {\n      if (uri?.includes('.mov')) {\n        return (\n          <Video\n            source={{ uri }}\n            rate={1.0}\n            volume={0}\n            isMuted={false}\n            resizeMode=\"contain\"\n            shouldPlay\n            isLooping\n            style={VIDEO}\n          />\n        )\n      } else if (uri?.includes('.jpg' || '.jpeg')) {\n        return (\n          <ProgressiveImage\n            thumbnailSource={{ uri: `https://images.unsplash.com/photo-1557683311-eac922347aa1?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1915&q=80` }}\n            source={{ uri }}\n            style={IMAGE}\n          />\n        )\n      }\n    }\n    return (\n      <View style={IMAGE_CONTAINER}>\n        <TouchableOpacity\n          onPress={() => uri ? navigation.navigate('story', { ...item }) : null}>\n          {renderFirstStory()}\n          <View style={OVERLAY}>\n            <Text style={OVERLAY_TEXT}>{item.name}</Text>\n          </View>\n        </TouchableOpacity>\n      </View>\n    )\n  }\n\n  const firstLayout = [\n    {\n      flexDirection: 'row',\n      flexWrap: 'wrap',\n      flex: 1,\n      justifyContent: 'center',\n      children: [\n        {\n          margin: spacing[2],\n          // flex: 1,\n          height: 250,\n          width: \"45%\"\n        },\n        {\n          margin: spacing[2],\n          // flex: 1,\n          height: 250,\n          width: \"45%\"\n        },\n        {\n          margin: spacing[2],\n          height: 250,\n          width: \"45%\"\n        },\n        {\n          margin: spacing[2],\n          height: 250,\n          width: \"45%\"\n        },\n        {\n          margin: spacing[2],\n          height: 250,\n          width: \"45%\"\n        },\n        {\n          margin: spacing[2],\n          height: 250,\n          width: \"45%\"\n        },\n      ]\n    },\n  ]\n\n  return (\n    <SafeAreaView style={ROOT}>\n      {\n        loading\n          ? <SkeletonContent\n            isLoading={true}\n            layout={firstLayout}\n          />\n          : <FlatList\n            refreshControl={<RefreshControl refreshing={refreshing} onRefresh={onRefresh} />}\n            data={userAndStories?.users}\n            renderItem={renderUsers}\n            keyExtractor={item => item.id}\n            showsHorizontalScrollIndicator={false}\n            numColumns={2}\n          />\n\n      }\n    </SafeAreaView>\n  )\n})\n"]},"metadata":{},"sourceType":"script"}