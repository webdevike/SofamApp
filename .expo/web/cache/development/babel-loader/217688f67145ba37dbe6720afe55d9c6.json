{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _reactNative = require(\"react-native\");\n\nvar _reservation = _interopRequireDefault(require(\"./reservation\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _xdate = _interopRequireDefault(require(\"xdate\"));\n\nvar _dateutils = _interopRequireDefault(require(\"../../dateutils\"));\n\nvar _style = _interopRequireDefault(require(\"./style\"));\n\nvar _jsxFileName = \"/Users/isaacweber/code/SofamApp/node_modules/react-native-calendars/src/agenda/reservation-list/index.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nvar ReservationList = function (_Component) {\n  (0, _inherits2.default)(ReservationList, _Component);\n\n  var _super = _createSuper(ReservationList);\n\n  function ReservationList(props) {\n    var _this;\n\n    (0, _classCallCheck2.default)(this, ReservationList);\n    _this = _super.call(this, props);\n    _this.styles = (0, _style.default)(props.theme);\n    _this.state = {\n      reservations: []\n    };\n    _this.heights = [];\n    _this.selectedDay = _this.props.selectedDay;\n    _this.scrollOver = true;\n    return _this;\n  }\n\n  (0, _createClass2.default)(ReservationList, [{\n    key: \"UNSAFE_componentWillMount\",\n    value: function UNSAFE_componentWillMount() {\n      this.updateDataSource(this.getReservations(this.props).reservations);\n    }\n  }, {\n    key: \"updateDataSource\",\n    value: function updateDataSource(reservations) {\n      this.setState({\n        reservations: reservations\n      });\n    }\n  }, {\n    key: \"updateReservations\",\n    value: function updateReservations(props) {\n      var reservations = this.getReservations(props);\n\n      if (this.list && !_dateutils.default.sameDate(props.selectedDay, this.selectedDay)) {\n        var scrollPosition = 0;\n\n        for (var i = 0; i < reservations.scrollPosition; i++) {\n          scrollPosition += this.heights[i] || 0;\n        }\n\n        this.scrollOver = false;\n        this.list.scrollToOffset({\n          offset: scrollPosition,\n          animated: true\n        });\n      }\n\n      this.selectedDay = props.selectedDay;\n      this.updateDataSource(reservations.reservations);\n    }\n  }, {\n    key: \"UNSAFE_componentWillReceiveProps\",\n    value: function UNSAFE_componentWillReceiveProps(props) {\n      var _this2 = this;\n\n      if (!_dateutils.default.sameDate(props.topDay, this.props.topDay)) {\n        this.setState({\n          reservations: []\n        }, function () {\n          _this2.updateReservations(props);\n        });\n      } else {\n        this.updateReservations(props);\n      }\n    }\n  }, {\n    key: \"onScroll\",\n    value: function onScroll(event) {\n      var yOffset = event.nativeEvent.contentOffset.y;\n      this.props.onScroll(yOffset);\n      var topRowOffset = 0;\n      var topRow;\n\n      for (topRow = 0; topRow < this.heights.length; topRow++) {\n        if (topRowOffset + this.heights[topRow] / 2 >= yOffset) {\n          break;\n        }\n\n        topRowOffset += this.heights[topRow];\n      }\n\n      var row = this.state.reservations[topRow];\n      if (!row) return;\n      var day = row.day;\n\n      var sameDate = _dateutils.default.sameDate(day, this.selectedDay);\n\n      if (!sameDate && this.scrollOver) {\n        this.selectedDay = day.clone();\n        this.props.onDayChange(day.clone());\n      }\n    }\n  }, {\n    key: \"onRowLayoutChange\",\n    value: function onRowLayoutChange(ind, event) {\n      this.heights[ind] = event.nativeEvent.layout.height;\n    }\n  }, {\n    key: \"renderRow\",\n    value: function renderRow(_ref) {\n      var item = _ref.item,\n          index = _ref.index;\n      return _react.default.createElement(_reactNative.View, {\n        onLayout: this.onRowLayoutChange.bind(this, index),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 7\n        }\n      }, _react.default.createElement(_reservation.default, {\n        item: item,\n        renderItem: this.props.renderItem,\n        renderDay: this.props.renderDay,\n        renderEmptyDate: this.props.renderEmptyDate,\n        theme: this.props.theme,\n        rowHasChanged: this.props.rowHasChanged,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 9\n        }\n      }));\n    }\n  }, {\n    key: \"getReservationsForDay\",\n    value: function getReservationsForDay(iterator, props) {\n      var day = iterator.clone();\n      var res = props.reservations[day.toString('yyyy-MM-dd')];\n\n      if (res && res.length) {\n        return res.map(function (reservation, i) {\n          return {\n            reservation: reservation,\n            date: i ? false : day,\n            day: day\n          };\n        });\n      } else if (res) {\n        return [{\n          date: iterator.clone(),\n          day: day\n        }];\n      } else {\n        return false;\n      }\n    }\n  }, {\n    key: \"onListTouch\",\n    value: function onListTouch() {\n      this.scrollOver = true;\n    }\n  }, {\n    key: \"getReservations\",\n    value: function getReservations(props) {\n      if (!props.reservations || !props.selectedDay) {\n        return {\n          reservations: [],\n          scrollPosition: 0\n        };\n      }\n\n      var reservations = [];\n\n      if (this.state.reservations && this.state.reservations.length) {\n        var _iterator = this.state.reservations[0].day.clone();\n\n        while (_iterator.getTime() < props.selectedDay.getTime()) {\n          var res = this.getReservationsForDay(_iterator, props);\n\n          if (!res) {\n            reservations = [];\n            break;\n          } else {\n            reservations = reservations.concat(res);\n          }\n\n          _iterator.addDays(1);\n        }\n      }\n\n      var scrollPosition = reservations.length;\n      var iterator = props.selectedDay.clone();\n\n      for (var i = 0; i < 31; i++) {\n        var _res = this.getReservationsForDay(iterator, props);\n\n        if (_res) {\n          reservations = reservations.concat(_res);\n        }\n\n        iterator.addDays(1);\n      }\n\n      return {\n        reservations: reservations,\n        scrollPosition: scrollPosition\n      };\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var reservations = this.props.reservations;\n\n      if (!reservations || !reservations[this.props.selectedDay.toString('yyyy-MM-dd')]) {\n        if (this.props.renderEmptyData) {\n          return this.props.renderEmptyData();\n        }\n\n        return _react.default.createElement(_reactNative.ActivityIndicator, {\n          style: {\n            marginTop: 80\n          },\n          color: this.props.theme && this.props.theme.indicatorColor,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 195,\n            columnNumber: 9\n          }\n        });\n      }\n\n      return _react.default.createElement(_reactNative.FlatList, {\n        ref: function ref(c) {\n          return _this3.list = c;\n        },\n        style: this.props.style,\n        contentContainerStyle: this.styles.content,\n        renderItem: this.renderRow.bind(this),\n        data: this.state.reservations,\n        onScroll: this.onScroll.bind(this),\n        showsVerticalScrollIndicator: false,\n        scrollEventThrottle: 200,\n        onMoveShouldSetResponderCapture: function onMoveShouldSetResponderCapture() {\n          _this3.onListTouch();\n\n          return false;\n        },\n        keyExtractor: function keyExtractor(item, index) {\n          return String(index);\n        },\n        refreshControl: this.props.refreshControl,\n        refreshing: this.props.refreshing || false,\n        onRefresh: this.props.onRefresh,\n        onScrollBeginDrag: this.props.onScrollBeginDrag,\n        onScrollEndDrag: this.props.onScrollEndDrag,\n        onMomentumScrollBegin: this.props.onMomentumScrollBegin,\n        onMomentumScrollEnd: this.props.onMomentumScrollEnd,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 7\n        }\n      });\n    }\n  }]);\n  return ReservationList;\n}(_react.Component);\n\nReservationList.displayName = 'IGNORE';\nReservationList.propTypes = {\n  rowHasChanged: _propTypes.default.func,\n  renderItem: _propTypes.default.func,\n  renderDay: _propTypes.default.func,\n  renderEmptyDate: _propTypes.default.func,\n  onDayChange: _propTypes.default.func,\n  onScroll: _propTypes.default.func,\n  reservations: _propTypes.default.object,\n  selectedDay: _propTypes.default.instanceOf(_xdate.default),\n  topDay: _propTypes.default.instanceOf(_xdate.default),\n  refreshControl: _propTypes.default.element,\n  refreshing: _propTypes.default.bool,\n  onRefresh: _propTypes.default.func,\n  onScrollBeginDrag: _propTypes.default.func,\n  onScrollEndDrag: _propTypes.default.func,\n  onMomentumScrollBegin: _propTypes.default.func,\n  onMomentumScrollEnd: _propTypes.default.func\n};\nvar _default = ReservationList;\nexports.default = _default;","map":{"version":3,"sources":["/Users/isaacweber/code/SofamApp/node_modules/react-native-calendars/src/agenda/reservation-list/index.js"],"names":["ReservationList","props","styles","theme","state","reservations","heights","selectedDay","scrollOver","updateDataSource","getReservations","setState","list","dateutils","sameDate","scrollPosition","i","scrollToOffset","offset","animated","topDay","updateReservations","event","yOffset","nativeEvent","contentOffset","y","onScroll","topRowOffset","topRow","length","row","day","clone","onDayChange","ind","layout","height","item","index","onRowLayoutChange","bind","renderItem","renderDay","renderEmptyDate","rowHasChanged","iterator","res","toString","map","reservation","date","getTime","getReservationsForDay","concat","addDays","renderEmptyData","marginTop","indicatorColor","c","style","content","renderRow","onListTouch","String","refreshControl","refreshing","onRefresh","onScrollBeginDrag","onScrollEndDrag","onMomentumScrollBegin","onMomentumScrollEnd","Component","displayName","propTypes","PropTypes","func","object","instanceOf","XDate","element","bool"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport {FlatList, ActivityIndicator, View} from 'react-native';\nimport Reservation from './reservation';\nimport PropTypes from 'prop-types';\nimport XDate from 'xdate';\n\nimport dateutils from '../../dateutils';\nimport styleConstructor from './style';\n\n\nclass ReservationList extends Component {\n  static displayName = 'IGNORE';\n\n  static propTypes = {\n    // specify your item comparison function for increased performance\n    rowHasChanged: PropTypes.func,\n    // specify how each item should be rendered in agenda\n    renderItem: PropTypes.func,\n    // specify how each date should be rendered. day can be undefined if the item is not first in that day.\n    renderDay: PropTypes.func,\n    // specify how empty date content with no items should be rendered\n    renderEmptyDate: PropTypes.func,\n    // callback that gets called when day changes while scrolling agenda list\n    onDayChange: PropTypes.func,\n    // onScroll ListView event\n    onScroll: PropTypes.func,\n    // the list of items that have to be displayed in agenda. If you want to render item as empty date\n    // the value of date key kas to be an empty array []. If there exists no value for date key it is\n    // considered that the date in question is not yet loaded\n    reservations: PropTypes.object,\n    selectedDay: PropTypes.instanceOf(XDate),\n    topDay: PropTypes.instanceOf(XDate),\n    refreshControl: PropTypes.element,\n    refreshing: PropTypes.bool,\n    onRefresh: PropTypes.func,\n    onScrollBeginDrag: PropTypes.func,\n    onScrollEndDrag: PropTypes.func,\n    onMomentumScrollBegin: PropTypes.func,\n    onMomentumScrollEnd: PropTypes.func\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.styles = styleConstructor(props.theme);\n\n    this.state = {\n      reservations: []\n    };\n\n    this.heights=[];\n    this.selectedDay = this.props.selectedDay;\n    this.scrollOver = true;\n  }\n\n  UNSAFE_componentWillMount() {\n    this.updateDataSource(this.getReservations(this.props).reservations);\n  }\n\n  updateDataSource(reservations) {\n    this.setState({\n      reservations\n    });\n  }\n\n  updateReservations(props) {\n    const reservations = this.getReservations(props);\n    if (this.list && !dateutils.sameDate(props.selectedDay, this.selectedDay)) {\n      let scrollPosition = 0;\n      for (let i = 0; i < reservations.scrollPosition; i++) {\n        scrollPosition += this.heights[i] || 0;\n      }\n      this.scrollOver = false;\n      this.list.scrollToOffset({offset: scrollPosition, animated: true});\n    }\n    this.selectedDay = props.selectedDay;\n    this.updateDataSource(reservations.reservations);\n  }\n\n  UNSAFE_componentWillReceiveProps(props) {\n    if (!dateutils.sameDate(props.topDay, this.props.topDay)) {\n      this.setState({\n        reservations: []\n      }, () => {\n        this.updateReservations(props);\n      });\n    } else {\n      this.updateReservations(props);\n    }\n  }\n\n  onScroll(event) {\n    const yOffset = event.nativeEvent.contentOffset.y;\n    this.props.onScroll(yOffset);\n    let topRowOffset = 0;\n    let topRow;\n    for (topRow = 0; topRow < this.heights.length; topRow++) {\n      if (topRowOffset + this.heights[topRow] / 2 >= yOffset) {\n        break;\n      }\n      topRowOffset += this.heights[topRow];\n    }\n    const row = this.state.reservations[topRow];\n    if (!row) return;\n    const day = row.day;\n    const sameDate = dateutils.sameDate(day, this.selectedDay);\n    if (!sameDate && this.scrollOver) {\n      this.selectedDay = day.clone();\n      this.props.onDayChange(day.clone());\n    }\n  }\n\n  onRowLayoutChange(ind, event) {\n    this.heights[ind] = event.nativeEvent.layout.height;\n  }\n\n  renderRow({item, index}) {\n    return (\n      <View onLayout={this.onRowLayoutChange.bind(this, index)}>\n        <Reservation\n          item={item}\n          renderItem={this.props.renderItem}\n          renderDay={this.props.renderDay}\n          renderEmptyDate={this.props.renderEmptyDate}\n          theme={this.props.theme}\n          rowHasChanged={this.props.rowHasChanged}\n        />\n      </View>\n    );\n  }\n\n  getReservationsForDay(iterator, props) {\n    const day = iterator.clone();\n    const res = props.reservations[day.toString('yyyy-MM-dd')];\n    if (res && res.length) {\n      return res.map((reservation, i) => {\n        return {\n          reservation,\n          date: i ? false : day,\n          day\n        };\n      });\n    } else if (res) {\n      return [{\n        date: iterator.clone(),\n        day\n      }];\n    } else {\n      return false;\n    }\n  }\n\n  onListTouch() {\n    this.scrollOver = true;\n  }\n\n  getReservations(props) {\n    if (!props.reservations || !props.selectedDay) {\n      return {reservations: [], scrollPosition: 0};\n    }\n    let reservations = [];\n    if (this.state.reservations && this.state.reservations.length) {\n      const iterator = this.state.reservations[0].day.clone();\n      while (iterator.getTime() < props.selectedDay.getTime()) {\n        const res = this.getReservationsForDay(iterator, props);\n        if (!res) {\n          reservations = [];\n          break;\n        } else {\n          reservations = reservations.concat(res);\n        }\n        iterator.addDays(1);\n      }\n    }\n    const scrollPosition = reservations.length;\n    const iterator = props.selectedDay.clone();\n    for (let i = 0; i < 31; i++) {\n      const res = this.getReservationsForDay(iterator, props);\n      if (res) {\n        reservations = reservations.concat(res);\n      }\n      iterator.addDays(1);\n    }\n\n    return {reservations, scrollPosition};\n  }\n\n  render() {\n    const {reservations} = this.props;\n    if (!reservations || !reservations[this.props.selectedDay.toString('yyyy-MM-dd')]) {\n      if (this.props.renderEmptyData) {\n        return this.props.renderEmptyData();\n      }\n      return (\n        <ActivityIndicator style={{marginTop: 80}} color={this.props.theme && this.props.theme.indicatorColor}/>\n      );\n    }\n    return (\n      <FlatList\n        ref={(c) => this.list = c}\n        style={this.props.style}\n        contentContainerStyle={this.styles.content}\n        renderItem={this.renderRow.bind(this)}\n        data={this.state.reservations}\n        onScroll={this.onScroll.bind(this)}\n        showsVerticalScrollIndicator={false}\n        scrollEventThrottle={200}\n        onMoveShouldSetResponderCapture={() => {this.onListTouch(); return false;}}\n        keyExtractor={(item, index) => String(index)}\n        refreshControl={this.props.refreshControl}\n        refreshing={this.props.refreshing || false}\n        onRefresh={this.props.onRefresh}\n        onScrollBeginDrag={this.props.onScrollBeginDrag}\n        onScrollEndDrag={this.props.onScrollEndDrag}\n        onMomentumScrollBegin={this.props.onMomentumScrollBegin}\n        onMomentumScrollEnd={this.props.onMomentumScrollEnd}\n      />\n    );\n  }\n}\n\nexport default ReservationList;\n"]},"metadata":{},"sourceType":"script"}